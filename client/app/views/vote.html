<div ng-include="'views/header.html'"></div>
<div class="container-fluid">
  <div class="row">
    <div ng-include="'views/sidebar.html'"></div>

    <div class="col-md-9">
      <div ng-include="'views/member_menu.html'"></div>
      <h1>希望曲投票
        <small ng-if="event.voteLimit < 9999">ただいまの上限曲数は {{ event.voteLimit }} 曲です。</small>
        <small ng-if="event.voteLimit == 9999">ただいまの上限曲数はありません</small>
      </h1>
      <si-alert si-alert="alert"></si-alert>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">投票にあたって主催からのメッセージ</h3>
        </div>
        <div class="panel-body">
          {{ event.voteMessage }}
        </div>
      </div>

      <div class="alert alert-info">
        <ul>
          <li><strong>上記の主催からのメッセージをよく読んだ上で、演奏したい曲にチェックを入れて「回答する」を押してください</strong></li>
          <li>一度回答しても、回答受付期間内なら回答を変更できます</li>
          <li>もし演奏したい曲が以下にない場合、自分で<a ui-sref="new_tune">楽曲登録</a>をして、あらためて回答してください</li>
        </ul>
      </div>
      <div class="form-group">
        <input type="text" ng-model="search" class="form-control" id="search" placeholder="テキストで絞りこむ">
      </div>
      <form>
        <button type="button" ng-click="vote()" ng-disabled="votedCount > event.voteLimit || votedCount == 0" class="btn btn-block btn-primary">回答する</button>
      </form>
      <table class="table table-hover">
        <thead>
        <tr>
          <th>希望</th>
          <th>楽曲名</th>
          <th>演奏時間</th>
          <th>アーティスト</th>
          <th>出典</th>
        </tr>
        </thead>
        <tr ng-repeat="tune in tunes | filter:search">
          <td><input type="checkbox" ng-model="tune.voted" ng-click="onClick()"></td>
          <td>{{ tune.name }}</td>
          <td>{{ tune.time | date:'mm:ss' }}</td>
          <td>{{ tune.artist }}</td>
          <td>{{ tune.source }}</td>
        </tr>
      </table>
    </div>
  </div>
</div>